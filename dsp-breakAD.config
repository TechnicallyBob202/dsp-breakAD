# dsp-breakAD Configuration File
# This file drives what each module does and how aggressive it is
# Format: Key=Value (no spaces around =)

################################################################################
# General Settings
################################################################################

# DryRun mode - log changes without applying them (future feature)
DryRun=false

# Target DSP Score (informational only)
TargetDSPScore=60-70

# Root OU for all breakAD objects
BreakAD_RootOU=breakAD

# Sub-OUs for organizing objects by type
BreakAD_UsersOU=Users
BreakAD_ComputersOU=Computers

################################################################################
# Infrastructure Security Module
################################################################################

# Schema Admin users to create and add to Schema Admins group
InfrastructureSecurity_SchemaAdminCount=2
InfrastructureSecurity_SchemaAdminPassword=SchemaAdm!nP@ss123
InfrastructureSecurity_SchemaAdminEnabled=true
InfrastructureSecurity_SchemaAdminDescription=Infrastructure Security Lab User - Schema Admin

# Enterprise Admin users to create and add to Enterprise Admins group
InfrastructureSecurity_EnterpriseAdminCount=1
InfrastructureSecurity_EnterpriseAdminPassword=EntAdm!nP@ss123
InfrastructureSecurity_EnterpriseAdminEnabled=true
InfrastructureSecurity_EnterpriseAdminDescription=Infrastructure Security Lab User - Enterprise Admin

# Enable print spooler on Domain Controllers (Critical: Execution vector)
InfrastructureSecurity_EnablePrintSpooler=true

# Modify dSHeuristics for dangerous settings
# Enables: anonymous access, NSPI access, weak password operations
InfrastructureSecurity_ModifydSHeuristics=true

# PHASE 4: Operator Groups (Backup, Print, Account Operators)
# When enabled, adds created users to these groups
InfrastructureSecurity_AddToOperatorGroups=true

# PHASE 5: Distributed COM and Performance Log Users
# When enabled, adds users to these groups
InfrastructureSecurity_AddToDistributedCOMUsers=true
InfrastructureSecurity_AddToPerformanceLogUsers=true

# PHASE 6: Configure DES Encryption
# When enabled, sets DES-only encryption on first Schema Admin user
InfrastructureSecurity_ConfigureDESEncryption=true

# PHASE 7: Disable Kerberos Pre-Auth
# When enabled, disables pre-auth on first Enterprise Admin user (AS-REP roasting)
InfrastructureSecurity_DisableKerberosPreAuth=true

# PHASE 8: Enable Reversible Encryption
# When enabled, sets reversible encryption flag on first created user
InfrastructureSecurity_EnableReversibleEncryption=true

# PHASE 9: Create Disabled Privileged Account
# When enabled, creates a disabled admin account
InfrastructureSecurity_CreateDisabledPrivilegedAccount=true

# PHASE 10: Add Computer to Privileged Groups
# When enabled, creates a computer account and adds it to Domain Admins
InfrastructureSecurity_AddComputerToPrivilegedGroups=true

################################################################################
# Account Security Module
################################################################################

# Number of bad user accounts to create with various misconfigs
AccountSecurity_BadUsersToCreate=3

# Include accounts with "password never expires" flag
AccountSecurity_IncludeNeverExpiringPasswords=true

# Include accounts with pre-authentication disabled (AS-REP roasting)
AccountSecurity_IncludePreAuthDisabled=true

# Include accounts with weak Kerberos encryption (DES, RC4)
AccountSecurity_IncludeWeakEncryption=true

# Include accounts with unconstrained delegation enabled
AccountSecurity_IncludeUnconstrainedDelegation=true

# Include accounts with constrained delegation configured
AccountSecurity_IncludeConstrainedDelegation=true

################################################################################
# Delegation Module
################################################################################

# Enable unconstrained delegation on test accounts
ADDelegation_EnableUnconstrainedDelegation=true

# Enable constrained delegation with dangerous SPNs
ADDelegation_EnableConstrainedDelegation=true

# Enable resource-based constrained delegation abuse
ADDelegation_EnableRBCDAbuse=true

################################################################################
# Kerberos Security Module
################################################################################

# Support weak encryption (RC4, DES)
KerberosSecurity_SupportWeakEncryption=true

# Support DES encryption specifically
KerberosSecurity_SupportDESEncryption=true

# Support RC4 encryption specifically
KerberosSecurity_SupportRC4Encryption=true

################################################################################
# Group Policy Security Module
################################################################################

# Weaken GPO permissions at domain level
GroupPolicySecurity_WeakenDomainGPOPermissions=true

# Weaken GPO permissions at DC OU level
GroupPolicySecurity_WeakenDCOUGPOPermissions=true

# Grant risky GPO Creator rights
GroupPolicySecurity_GrantRiskyGPOCreatorRights=true