# dsp-breakAD Configuration File
# Module 01: Infrastructure Security

################################################################################
# General Settings
################################################################################

DryRun=false
TargetDSPScore=60-70
BreakAD_RootOU=breakAD
BreakAD_UsersOU=Users
BreakAD_ComputersOU=Computers

################################################################################
# Module 01: Infrastructure Security
################################################################################

# PHASE 1: Enable dSHeuristics (Anonymous NSPI Access)
InfrastructureSecurity_EnabledSHeuristics=true
InfrastructureSecurity_dSHeuristicsValue=00000001

# PHASE 2: Enable Print Spooler on DCs
InfrastructureSecurity_EnablePrintSpooler=true

# PHASE 3: Disable LDAP Signing on DCs (via GPO)
InfrastructureSecurity_DisableLDAPSigning=true

# PHASE 4: Disable SMB Signing on DCs (via GPO)
InfrastructureSecurity_DisableSMBSigning=true

# PHASE 5: Enable SMBv1 on DCs (via GPO)
# NOTE: Registry approach alone does not work - requires different method
# Disabled pending investigation into proper SMBv1 enablement
InfrastructureSecurity_EnableSMBv1=false

# PHASE 6: Add Anonymous to Pre-Windows 2000 Compatible Access
InfrastructureSecurity_AddAnonymousPre2000=true

# PHASE 7: Disable AdminSDHolder SDProp Protection
InfrastructureSecurity_DisableAdminSDHolder=true

# PHASE 8: Set Dangerous Trust Attributes
InfrastructureSecurity_DangerousTrustAttribute=true

# PHASE 9: Add Well-Known Privileged SIDs to SIDHistory
InfrastructureSecurity_AddPrivilegedSIDHistory=true

# PHASE 10: Modify Schema Permissions
InfrastructureSecurity_ModifySchemaPermissions=true

# PHASE 11: Unsecured DNS Configuration
InfrastructureSecurity_UnsecuredDNS=true