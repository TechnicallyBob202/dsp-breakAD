################################################################################
# dsp-breakAD Configuration File
# Controls which IOEs are enabled for each module
################################################################################

################################################################################
# OU Configuration
################################################################################

BreakAD_RootOU=BreakAD
BreakAD_UsersOU=Users
BreakAD_ComputersOU=Computers

################################################################################
# Module 1: Infrastructure Security Configuration
################################################################################

# PHASE 1: Enable dSHeuristics (Anonymous NSPI Access)
InfrastructureSecurity_EnabledSHeuristics=true
InfrastructureSecurity_dSHeuristicsValue=00000001

# PHASE 2: Enable Print Spooler on DCs
InfrastructureSecurity_EnablePrintSpooler=true

# PHASE 3: Disable LDAP Signing on DCs (via GPO)
InfrastructureSecurity_DisableLDAPSigning=true

# PHASE 4: Disable SMB Signing on DCs (via GPO)
InfrastructureSecurity_DisableSMBSigning=true

# PHASE 5: Enable SMBv1 on DCs (via GPO)
InfrastructureSecurity_EnableSMBv1=false

# PHASE 6: Add Anonymous to Pre-Windows 2000 Compatible Access
InfrastructureSecurity_AddAnonymousPre2000=true

# PHASE 7: Modify Schema Permissions
InfrastructureSecurity_ModifySchemaPermissions=true

# PHASE 8: Disable LDAP Channel Binding
InfrastructureSecurity_DisableLDAPChannelBinding=true

# PHASE 9: Unsecured DNS Configuration
InfrastructureSecurity_UnsecuredDNS=false

################################################################################
# Module 2: Account Security Configuration
################################################################################

# Use built-in Administrator account (recent activity within 2 weeks)
# NOTE: DISABLED - Do not reset built-in Administrator password
AccountSecurity_UseBuiltInAdmin=false

# Set built-in Administrator password to old (180+ days)
AccountSecurity_AdminOldPassword=true

# Create privileged accounts with password that never expires
AccountSecurity_PrivilegedPwdNeverExpires=true

# Create user accounts with reversible encryption enabled
AccountSecurity_ReversibleEncryption=true

# Create user accounts with DES encryption only
AccountSecurity_DESEncryption=true

# Create user accounts with password not required
AccountSecurity_PwdNotRequired=true

# Create user accounts with Kerberos pre-authentication disabled
AccountSecurity_PreAuthDisabled=true

# Create unprivileged accounts with adminCount=1
AccountSecurity_UnprivilegedAdminCount=true

# Create user accounts with old passwords (90+ days)
AccountSecurity_OldPasswords=true

# Create privileged users that are disabled
AccountSecurity_DisabledPrivilegedUsers=true

# Create recent privileged account creation activity
AccountSecurity_RecentPrivilegedCreation=true

# Create new AD objects (within 10 days)
AccountSecurity_RecentObjectCreation=true

# Create smart card users with old passwords
AccountSecurity_SmartCardOldPassword=false

# Create privileged accounts with weak Fine-Grained Password Policy
AccountSecurity_WeakFGPP=true

################################################################################
# Module 3: Group Policy Security Configuration
################################################################################

# GPO naming (at Domain, Site, and DC OU levels)
GroupPolicySecurity_GPOName_Domain=breakAD-GroupPolicySecurity-Domain
GroupPolicySecurity_GPOName_Site=breakAD-GroupPolicySecurity-Site
GroupPolicySecurity_GPOName_DC=breakAD-GroupPolicySecurity-DC

# Enable dangerous user rights assignments
GroupPolicySecurity_DangerousUserRights=true

# Enable reversible password storage in GPO
GroupPolicySecurity_ReversiblePasswords=true

# Configure writable shortcuts in GPO
GroupPolicySecurity_WritableShortcuts=true

# Configure dangerous logon script paths
GroupPolicySecurity_DangerousLogonScript=true

# Enable weak LM hash storage in GPO
GroupPolicySecurity_WeakLMHash=true

# Configure scheduled tasks in GPO
GroupPolicySecurity_ScheduledTasks=true

# Grant GPO linking delegation
GroupPolicySecurity_GrantDelegation=true