# dsp-breakAD Configuration File
# This file drives what each module does and how aggressive it is
# Format: Key=Value (no spaces around =)

################################################################################
# General Settings
################################################################################

# DryRun mode - log changes without applying them (future feature)
DryRun=false

# Target DSP Score (informational only)
TargetDSPScore=60-70

# Root OU for all breakAD objects
BreakAD_RootOU=breakAD

# Sub-OUs for organizing objects by type
BreakAD_UsersOU=Users
BreakAD_ComputersOU=Computers

################################################################################
# Infrastructure Security Module
################################################################################

# Schema Admin users to create and add to Schema Admins group
InfrastructureSecurity_SchemaAdminCount=2
InfrastructureSecurity_SchemaAdminPassword=SchemaAdm!nP@ss123
InfrastructureSecurity_SchemaAdminEnabled=true
InfrastructureSecurity_SchemaAdminDescription=Infrastructure Security Lab User - Schema Admin

# Enterprise Admin users to create and add to Enterprise Admins group
InfrastructureSecurity_EnterpriseAdminCount=1
InfrastructureSecurity_EnterpriseAdminPassword=EntAdm!nP@ss123
InfrastructureSecurity_EnterpriseAdminEnabled=true
InfrastructureSecurity_EnterpriseAdminDescription=Infrastructure Security Lab User - Enterprise Admin

# Enable print spooler on Domain Controllers (Critical: Execution vector)
InfrastructureSecurity_EnablePrintSpooler=true

# Modify dSHeuristics for dangerous settings
# Enables: anonymous access, NSPI access, weak password operations
InfrastructureSecurity_ModifydSHeuristics=true

# Weaken AdminSDHolder protection (removes protection from privileged groups)
InfrastructureSecurity_WeakenAdminSDHolder=false

################################################################################
# Account Security Module
################################################################################

# Number of bad user accounts to create (5 recommended for all weak properties)
AccountSecurity_BadUsersToCreate=5

# User 1: Password never expires
AccountSecurity_IncludeNeverExpiringPasswords=true

# User 2: Pre-auth disabled (AS-REP roasting vector)
AccountSecurity_IncludePreAuthDisabled=true

# Users 1-3: Weak Kerberos encryption (DES, RC4, DES+RC4)
AccountSecurity_IncludeWeakEncryption=true

# Users 1-2: Unconstrained delegation enabled
AccountSecurity_IncludeUnconstrainedDelegation=true

# User 3: Constrained delegation to dangerous SPNs (LDAP, CIFS, HOST)
AccountSecurity_IncludeConstrainedDelegation=true

# User 4: Password stored in description field
AccountSecurity_IncludeWeakPasswordStorage=true

# User 5: Service account abuse (shared password, never expires)
AccountSecurity_IncludeServiceAccountAbuse=true

################################################################################
# AD Delegation Module
################################################################################

# Grant bad actors dangerous delegation permissions
ADDelegation_GrantDangerousPermissions=true

# Create computers with unconstrained delegation
ADDelegation_IncludeComputerDelegation=true

# Modify ACLs on sensitive objects (Groups, Users container)
ADDelegation_ModifySensitiveACLs=true

# Grant reset password rights to non-admin users
ADDelegation_GrantResetPasswordRights=true

################################################################################
# Kerberos Security Module
################################################################################

# Create users/computers with DES encryption only
KerberosSecurity_IncludeDESEncryption=true

# Create users with RC4 encryption only
KerberosSecurity_IncludeRC4Encryption=true

# Create users with multiple weak encryptions
KerberosSecurity_IncludeMultipleWeakEncryptions=true

# Disable pre-auth on computer accounts (AS-REP roasting)
KerberosSecurity_DisableComputerPreAuth=true

# Create users with weak SPNs
KerberosSecurity_IncludeWeakSPNs=true

################################################################################
# Group Policy Security Module
################################################################################

# Weaken GPO link permissions at domain level
GroupPolicySecurity_WeakenDomainGPOPermissions=true

# Weaken GPO link permissions at DC OU level
GroupPolicySecurity_WeakenDCOUGPOPermissions=true

# Grant GPO Creator rights to non-admin users
GroupPolicySecurity_GrantGPOCreatorRights=true

# Modify Default Domain Policy
GroupPolicySecurity_ModifyDefaultDomainPolicy=true

# Disable GPO auditing on sensitive GPOs
GroupPolicySecurity_DisableGPOAuditing=true
