################################################################################
# dsp-breakAD Configuration File
# Controls which IOEs are enabled for each module
################################################################################

################################################################################
# OU Configuration
################################################################################

BreakAD_RootOU=BreakAD
BreakAD_UsersOU=Users
BreakAD_ComputersOU=Computers

################################################################################
# Module 1: Infrastructure Security Configuration
################################################################################

# PHASE 1: Enable dSHeuristics (Anonymous NSPI Access)
InfrastructureSecurity_EnabledSHeuristics=true
InfrastructureSecurity_dSHeuristicsValue=00000001

# PHASE 2: Enable Print Spooler on DCs
InfrastructureSecurity_EnablePrintSpooler=true

# PHASE 3: Disable LDAP Signing on DCs (via GPO)
InfrastructureSecurity_DisableLDAPSigning=true

# PHASE 4: Disable SMB Signing on DCs (via GPO)
InfrastructureSecurity_DisableSMBSigning=true

# PHASE 5: Enable SMBv1 on DCs (via GPO)
InfrastructureSecurity_EnableSMBv1=false

# PHASE 6: Add Anonymous to Pre-Windows 2000 Compatible Access
InfrastructureSecurity_AddAnonymousPre2000=true

# PHASE 7: Modify Schema Permissions
InfrastructureSecurity_ModifySchemaPermissions=true

# PHASE 8: Disable LDAP Channel Binding
InfrastructureSecurity_DisableLDAPChannelBinding=true

# PHASE 9: Unsecured DNS Configuration
InfrastructureSecurity_UnsecuredDNS=false

################################################################################
# Module 2: Account Security Configuration
################################################################################

# Use built-in Administrator account (recent activity within 2 weeks)
# NOTE: DISABLED - Do not reset built-in Administrator password
AccountSecurity_UseBuiltInAdmin=false

# Set built-in Administrator password to old (180+ days)
AccountSecurity_AdminOldPassword=true

# Create privileged accounts with password that never expires
AccountSecurity_PrivilegedPwdNeverExpires=true

# Create user accounts with reversible encryption enabled
AccountSecurity_ReversibleEncryption=true

# Create user accounts with DES encryption only
AccountSecurity_DESEncryption=true

# Create user accounts with password not required
AccountSecurity_PwdNotRequired=true

# Create user accounts with Kerberos pre-authentication disabled
AccountSecurity_PreAuthDisabled=true

# Create unprivileged accounts with adminCount=1
AccountSecurity_UnprivilegedAdminCount=true

# Create user accounts with old passwords (90+ days)
AccountSecurity_OldPasswords=true

# Create privileged users that are disabled
AccountSecurity_DisabledPrivilegedUsers=true

# Create recent privileged account creation activity
AccountSecurity_RecentPrivilegedCreation=true

# Create new AD objects (within 10 days)
AccountSecurity_RecentObjectCreation=true

# Create smart card users with old passwords
AccountSecurity_SmartCardOldPassword=false

# Create privileged accounts with weak Fine-Grained Password Policy
AccountSecurity_WeakFGPP=true

################################################################################
# Module 3: AD Delegation Configuration
################################################################################

# Enable AdminSDHolder inheritance
ADDelegation_EnableAdminSDHolderInheritance=false

# Add users to Account Operators
ADDelegation_AddAccountOperators=false

# Add users to Backup Operators
ADDelegation_AddBackupOperators=false

# Add users to Server Operators
ADDelegation_AddServerOperators=false

# Add users to Print Operators
ADDelegation_AddPrintOperators=false

# Grant reset password rights
ADDelegation_GrantResetPasswordRights=false

# Grant user account creation rights
ADDelegation_GrantCreateUserRights=false

# Grant DNS Admin rights
ADDelegation_GrantDNSAdminRights=false

################################################################################
# Module 4: Kerberos Security Configuration
################################################################################

# Create users with DES encryption only
KerberosSecurity_IncludeDESEncryption=false

# Create users with RC4 encryption only
KerberosSecurity_IncludeRC4Encryption=false

# Create users with multiple weak encryptions
KerberosSecurity_IncludeMultipleWeakEncryptions=false

# Disable pre-auth on computer accounts (AS-REP roasting)
KerberosSecurity_DisableComputerPreAuth=false

# Create users with weak SPNs
KerberosSecurity_IncludeWeakSPNs=false

# Enable Kerberos delegation
KerberosSecurity_EnableKerberosDelegation=false

# Enable resource-based constrained delegation
KerberosSecurity_EnableRBCD=false

################################################################################
# Module 5: Group Policy Security Configuration
################################################################################

# Weaken GPO link permissions at domain level
GroupPolicySecurity_WeakenDomainGPOPermissions=false

# Weaken GPO link permissions at DC OU level
GroupPolicySecurity_WeakenDCOUGPOPermissions=false

# Grant GPO Creator rights to non-admin users
GroupPolicySecurity_GrantGPOCreatorRights=false

# Modify Default Domain Policy
GroupPolicySecurity_ModifyDefaultDomainPolicy=false

# Disable GPO auditing on sensitive GPOs
GroupPolicySecurity_DisableGPOAuditing=false

################################################################################
# General Settings
################################################################################

# DryRun mode - log changes without applying them
DryRun=false

# Target DSP Score (informational only)
TargetDSPScore=60-70